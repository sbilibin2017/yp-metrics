# Яндекс Практикум "Продвинутый Go Разработчик"(сервис сбора метрик и алертинга)

## Описание проекта

Это сервер для сбора runtime-метрик, разработанный в рамках трека «Сервис сбора метрик и алертинга» на курсе Яндекс Практикум «Продвинутый Go разработчик».  
Сервер принимает метрики от агентов по HTTP и хранит их в памяти.

Метрики бывают двух типов:

- **gauge** (float64): новое значение заменяет предыдущее;
- **counter** (int64): новое значение прибавляется к предыдущему.

Сервер доступен по адресу `http://localhost:8080` и принимает POST-запросы вида:  
`/update/{type}/{name}/{value}`, где:

- `type` — тип метрики (`gauge` или `counter`),
- `name` — имя метрики,
- `value` — значение метрики (float64 для gauge, int64 для counter).

При успешном приёме возвращается HTTP 200 OK.  
Если имя метрики отсутствует — HTTP 404 Not Found.  
При некорректном типе или значении — HTTP 400 Bad Request.

---

## Архитектура проекта

проект разделен на 3 слоя:

1. обработка запросов (handlers)
2. бизнес логика (services)
3. работа с хранилищем (repositories)

взаимодествие слоев осуществляется через интерфейсы с использованием строго определнных структур данных


## Структура проекта

```
.
├── cmd # Команды и точка входа в приложение
│ ├── agent # Клиент-агент для отправки метрик (реализуется в следующих инкрементах)
│ │ └── main.go # Точка входа агента
│ └── server # Сервер сбора метрик
│ ├── main.go # Точка входа сервера
│ └── main_test.go # Тесты для сервера
├── go.mod # Модульные зависимости проекта
├── go.sum # Контрольные суммы зависимостей
├── internal # Внутренние пакеты приложения
│ ├── handlers # HTTP обработчики запросов
│ │ ├── metric_update_path.go # Обработчик обновления метрик через URL
│ │ ├── metric_update_path_mock.go # Моки для тестов обработчиков
│ │ └── metric_update_path_test.go # Тесты для обработчиков
│ ├── logger # Логирование приложения
│ │ ├── logger.go # Инициализация и конфигурация логгера
│ │ └── logger_test.go # Тесты логгера
│ ├── repositories # Репозитории для хранения метрик
│ │ ├── metric_memory_save.go # Репозиторий хранения в памяти
│ │ └── metric_memory_save_test.go # Тесты репозитория
│ ├── services # Логика обновления и обработки метрик
│ │ ├── metric_update.go # Сервис обновления метрик
│ │ ├── metric_update_mock.go # Моки для тестов сервиса
│ │ └── metric_update_test.go # Тесты сервиса
│ └── types # Типы и структуры данных
│ ├── api_error.go # Ошибки API
│ └── metrics.go # Типы метрик и связанные константы
├── Makefile # Скрипты для сборки и запуска
└── README.md # Документация проекта
```

---

## Используемые технологии

| Технология / Библиотека | Описание                              |
|-------------------------|-------------------------------------|
| Go                      | Язык программирования                |
| Chi                     | HTTP роутер                         |
| Resty                   | HTTP клиент для тестов              |
| Testify                 | Фреймворк для тестирования          |

---

## Инкременты проекта

| Итерация | Описание                                      | Ссылка на PR                         |
|----------|-----------------------------------------------|------------------------------------|
| iter1    | Реализация сервера сбора метрик с HTTP API   | https://github.com/sbilibin2017/yp-metrics/pull/1|
---

## Запуск проекта

1. Клонируйте репозиторий и перейдите в директорию `cmd/server`.
2. Выполните сборку:

```bash
go build -o server .